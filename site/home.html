 <!doctype html>
<html>
    <head>
        <meta charset = "utf-8">
        <title>Space Adventure</title>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,400,700,600' rel='stylesheet' type='text/css'>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <link href="./styles/gameStyle.css" rel="stylesheet">
        
        <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
        
        <script>
            var loc = "ship";
			var level = "_0_";
            var showingStats = false;
			var cardinal = ["north", "east", "west", "south", "a", "b", "c", "d"];
            
            //sounds
            var clickSound = new Audio("sounds/click.wav");
            
            $(window).on("load",function(){
			
				window.addEventListener("message", miniGameResult, false);
                loadscript();
				//update(level);
            });
			
			function explore(fight, discover, goal){

				var chance = Math.ceil(Math.random() * 100);
				switch(true){
					case (chance <= discover):
						newLevel =  goal;
						update(newLevel);
						break;
					case (chance <= fight):
						newLevel = level + "_fight";
						update(newLevel);
						break;
                    default:
                        newLevel = level + "_none";
                        update(newLevel);
				}
			};
            
            function playClickSound(){
                clickSound.play();
            };

            <!-- When the new location is needed, edit location and run loadscript() -->
            function loadscript(){
                var src = "./prompts/" + loc + ".js" + "?" + Math.random();  
                var head= document.getElementsByTagName('head')[0];
                var script= document.createElement('script');
                script.type= 'text/javascript';
                script.src= src;
                head.appendChild(script);  

				$(script).on("load",function(){
					update(level);
					
					// Old style that I updated
					//Button Click functionality
				
				$("button").on("click",function(){
						console.log(level);
						var id = this.id;
						var dir_go = id + "_go";
						if (levels[level][dir_go]){
							newLevel = levels[level][dir_go];
							update(newLevel);
						}
                        playClickSound();
					});
                });
            }
			
			function update(newLevel) {
				level = newLevel;
				//Toggle Directional keys as needed.
				for (dir in cardinal) {
						var dir_go = cardinal[dir] + "_go";
						if (!levels[level][dir_go]) {
							$("#" + cardinal[dir]).hide();
						} else {
							$("#" + cardinal[dir]).show();
						}
					}
					
				//If the location runs a game, find the file and append the game screen
				if (levels[level].game) {
					var miniGame = document.createElement("iframe");
					miniGame.id = "miniGame";
					$(miniGame).attr('src', levels[level].game);
					document.getElementById("layoutLeft").appendChild(miniGame);
					$("#textGame").hide();
				} 
				
				else if(levels[level].battle){
					levels[level].battle();
				}
				
				else if (levels[level].explore) {
					levels[level].explore();
				}
				
				else if (levels[level].location) {
					// Set location to the next locataion (ship or planet)
					loc = levels[level].location;
					// Set the level to the starting level described in the levels object
					level = levels[level].start;
					loadscript();
				}
				
				else if (levels[level].condition) {
					var condition = levels[level].condition;
					var pass = levels[level].pass;
					switch (condition) {
						case "Starmap":
							if (inventory["Starmap"]){
								newLevel = level + "_accept";
								update(newLevel);
							}
							
							else {
								newLevel = level + "_deny";
								update(newLevel);
							}
							break;	
						case "map":
							if (hiddenStats.planet2Base){
								newLevel = level + "_accept";
								update(newLevel);
							}
							
							else {
								newLevel = level + "_deny";
								update(newLevel);
							}
						case "coordinator":
							switch (true) {
								case (hiddenStats.coordinator < 10) :
									newLevel = level + "_a";
									update(newLevel);
									break;
								case (hiddenStats.coordinator < 20) :
									newLevel = level + "_b";
									update(newLevel);
									break;
								case (hiddenStats.coordinator < 30) :
									newLevel = level + "_c";
									update(newLevel);
									break;
								case (hiddenStats.coordinator < 40) :
									newLevel = level + "_d";
									update(newLevel);
									break;
							}
							hiddenStats.coordinator += 10;
					}
				}
				//Otherwise, update the prompt and options.
				else {
					$("#displayprompt").html(levels[newLevel].prompt);
					$("#a").html(levels[newLevel].a); 
					$("#b").html(levels[newLevel].b);
				}
			}
						
             <!-- function to toggle between the stats and inventory menu when the toggle button is clicked -->
            function toggle() {
                var invDiv = document.getElementById("sidebarMenu");
                var statDiv = document.getElementById("statMenu");
                var toggleText = document.getElementById("invStatToggle");
                playClickSound();
				$(invDiv).toggle();
				$(statDiv).toggle();
                if(showingStats) {
                    showingStats = false;
                    toggleText.innerHTML = "Show Stats";
                }
                else {
                    showingStats = true;
                    toggleText.innerHTML = "Show Inventory";
                }
            }
			
			function miniGameResult(e) {			
				$("#miniGame").remove();
				$("#textGame").show();
				if (e.data.success) {
					if (levels[level].reward) {
						levels[level].reward();
					}
					update(levels[level].success);
				}
				else {
					update(levels[level].fail);
				}
				
			}
            
        </script>
    </head>
    <body>
        <main> 
			<div id="layoutLeftgame">
				<div id="background" class="layoutArea">
					<div id="header-area">
						<div id="display-hero">
							<h1><strong>Marc</strong></h1>
							<h3><strong>HP:</strong> <span id="HP-Current">--</span>/<span id="HP-Total">--</span></h3>
							<h3><strong>MP:</strong> <span id="MP-Current">--</span>/<span id="MP-Total">--</span></h3>
						</div><!-- /display-hero -->
						
						<div id="exit"><p>Exit</p></div>
						<div id="Restart"><p>Restart</p></div>
						
						<div id="display-monster">
							<h1><strong><span id="Monster-Name">Enemy</span></strong></h1>
							<h3><strong>HP:</strong> <span id="Monster-HP">--</span>/<span id="Monster-HP-Total">--</span></h3>
							<h3>&nbsp;</h3>
						</div><!-- /display-monster -->
					</div>
					<div id="spacer">
						<div id="enemy-pic"></div>
						<!-- stuff might go here? -->
					</div>
					<div id="footer-area">
						<div id="battle-info">
							<p id="player-actions">an enemy faces you</p>
							<p id="enemy-actions">good luck</p>
						</div>
						<div id="choices">
							<div id="Heal" class="action">
								<p>Heal</p>
							</div>
							<div id="Attack" class="action">
								<p>Attack</p>
							</div>
							<div id="MagicMissile" class="action">
								<p>Magic Missile</p>
							</div>
							<div id="Run" class="action">
								<p>Run</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="layoutLeft">
				<div id="textGame">
					<div id="textOutput" class="layoutArea">
						<div id="prompt">
							<p id="displayprompt">Welcome</p>
						</div>
					</div>
					
					<div id="actionButtons" class="layoutArea">
						<button class="btn" id="a" onclick = "playClickSound()">Begin</button>
						<button class="btn" id="b" onclick = "playClickSound()">Quit</button>
						<button class="btn" id="c" onclick = "playClickSound()"></button>
						<button class="btn" id="d" onclick = "playClickSound()"></button>
					</div>
				</div>
			</div>
			<div id="layoutRight">
				<div id="invStatToggle" class="layoutArea" onclick = "toggle()">
					Show Stats
				</div>
				<div id="statMenu" class ="layoutArea sidebar">
					<script id = "statScript" type = "text/javascript" src = "prompts/stats.js"></script>
				</div>
				<div id="sidebarMenu" class="layoutArea sidebar">
					<script id = "invScript" type="text/javascript" src="prompts/inventory.js"></script>
				</div>
				<div id="movementButtons" class="layoutArea">
					<p>
						<button class="mvbtn" id="north" onclick = "playClickSound()">North</button>
						<button class="mvbtn" id="east" onclick = "playClickSound()">East</button>
					</p><p>
						<button class="mvbtn" id="west" onclick = "playClickSound()">West</button>
						<button class="mvbtn" id="south" onclick = "playClickSound()">South</button>
					</p>
				</div>
			</div> 
			<script type="text/javascript" src="minigames/BattleGame/game.js"></script>
		</main>
    </body>
</html>